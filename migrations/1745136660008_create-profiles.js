/**
 * Represents a migration script function used to create the "profiles" table.
 *
 * @param {object} pgm - The migration object responsible for defining database schema changes.
 *
 * The table schema includes:
 * - `id`: Primary key automatically generated by the database.
 * - `user_id`: Reference to the "users" table's `user_id` column, must be unique, not null, and cascades on delete.
 * - `name`: The name of the profile, stored as a VARCHAR.
 * - `main_nickname`: Unique and required nickname associated with the profile.
 * - `role`: User's role in the platform, restricted to 'покупатель', 'продавец', or 'нейтрал'.
 * - `prime_start` and `prime_end`: Time values indicating prime activity intervals.
 * - `raid_experience`: Array of raid-related experience, nullable.
 * - `sales_experience`: Description of sales-related experience, stored as a VARCHAR.
 * - `achievements`: Array of achievements associated with the profile.
 */
export const up = (pgm) => {
    pgm.createTable("profiles", {
        id: "id",
        user_id: { type: "VARCHAR", unique: true, references: "users(user_id)", onDelete: "CASCADE", notNull: true },
        name: { type: "VARCHAR" },
        main_nickname: { type: "VARCHAR", unique: true, notNull: true },
        role: { type: "VARCHAR(20)", check: "role IN ('покупатель', 'продавец', 'нейтрал')" },
        prime_start: { type: "TIME" },
        prime_end: { type: "TIME" },
        raid_experience: { type: "VARCHAR[]", notNull: false },
        sales_experience: { type: "VARCHAR" },
        achievements: { type: "VARCHAR[]" },
    });
};

/**
 * Performs the down migration for the database schema, reversing any schema changes made during the up migration.
 * Specifically, this function drops the "profiles" table from the database schema.
 *
 * @param {object} pgm - The database migration object, typically provided by the migration framework,
 * which provides methods to modify and revert database schema changes.
 */
export const down = (pgm) => {
    pgm.dropTable("profiles");
};
